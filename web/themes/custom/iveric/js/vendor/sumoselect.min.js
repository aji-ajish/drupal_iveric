(function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)})(e=>{e.fn.SumoSelect=function(t){const l=(e,t)=>{let l=null;"function"==typeof Event?l=new Event(t,{bubbles:!0}):(l=document.createEvent("Event"),l.initEvent(t,!0,!0)),e.dispatchEvent(l)};window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);const s={placeholder:"Select Here",csvDispCount:3,captionFormat:"{0} Selected",captionFormatAllSelected:"{0} all selected!",floatWidth:400,forceCustomRendering:!1,nativeOnDevice:["Android","BlackBerry","iPhone","iPad","iPod","Opera Mini","IEMobile","Silk"],outputAsCSV:!1,csvSepChar:",",okCancelInMulti:!1,isClickAwayOk:!1,triggerChangeCombined:!0,selectAll:!1,selectAllPartialCheck:!0,search:!1,searchText:"Search...",searchFn:(e,t)=>e.toLowerCase().indexOf(t.toLowerCase())<0,noMatch:'No matches for "{0}"',prefix:"",locale:["OK","Cancel","Select All","Clear all"],up:!1,showTitle:!0,clearAll:!1,closeAfterClearAll:!1,max:null,renderLi:(e,t)=>e},i=this.each(function(){const i=this;if(this.sumo||!e(this).is("select"))return;const o=e.extend({},s,t,e(this).data());this.sumo={E:e(i),is_multi:e(i).attr("multiple"),select:"",caption:"",placeholder:"",optDiv:"",CaptionCont:"",ul:"",is_floating:!1,is_opened:!1,mob:!1,Pstate:[],lastUnselected:null,selectedCount:0,createElems(){const t=this,l=t.E.find("option:checked");t.E.wrap('<div class="SumoSelect" tabindex="0" role="button" aria-expanded="false">'),l.each((e,t)=>{t.selected=!0}),t.select=t.E.parent(),t.caption=e("<span>"),t.CaptionCont=e(`<p class="CaptionCont SelectBox ${t.E.attr("class")}" ><label><i></i></label></p>`).attr("style",t.E.attr("style")).prepend(t.caption),t.select.append(t.CaptionCont),t.is_multi||(o.okCancelInMulti=!1),t.E.attr("disabled")&&t.select.addClass("disabled").removeAttr("tabindex"),o.outputAsCSV&&t.is_multi&&t.E.attr("name")&&(t.select.append(e('<input class="HEMANT123" type="hidden" />').attr("name",t.E.attr("name")).val(t.getSelStr())),t.E.removeAttr("name")),!t.isMobile()||o.forceCustomRendering?(t.E.attr("name")&&t.select.addClass(`sumo_${t.E.attr("name").replace(/\[\]/,"")}`),t.E.addClass("SumoUnder").attr("tabindex","-1"),t.optDiv=e(`<div class="optWrapper ${o.up?"up":""}">`),t.floatingList(),t.ul=e('<ul class="options">'),t.optDiv.append(t.ul),o.clearAll&&t.is_multi&&t.ClearAll(),o.selectAll&&t.is_multi&&!o.max&&t.SelAll(),o.search&&t.Search(),t.ul.append(t.prepItems(t.E.children())),t.is_multi&&t.multiSelelect(),t.select.append(t.optDiv),t._handleMax(),t.basicEvents(),t.selAllState()):t.setNativeMobile()},prepItems(t,l){const s=[],i=this;return e(t).each((t,o)=>{const a=e(o);s.push(a.is("optgroup")?e(`<li class="group ${o.disabled?"disabled":""}"><label></label><ul></ul></li>`).find("label").text(a.attr("label")).end().find("ul").append(i.prepItems(a.children(),o.disabled)).end():i.createLi(a,l))}),s},createLi(t,l){const s=this;t.attr("value")||t.attr("value",t.val());const i=e(`<li class="opt"><label>${t.html()}</label></li>`);return i.data("opt",t),t.data("li",i),s.is_multi&&i.prepend("<span><i></i></span>"),(t[0].disabled||l)&&i.addClass("disabled"),s.onOptClick(i),t[0].selected&&(i.addClass("selected"),s.selectedCount++),t.attr("class")&&i.addClass(t.attr("class")),t.attr("title")&&i.attr("title",t.attr("title")),o.renderLi(i,t)},getSelStr(){const t=[];return this.E.find("option:checked").each(function(){t.push(e(this).val())}),t.join(o.csvSepChar)},multiSelelect(){const t=this;t.optDiv.addClass("multiple"),t.okbtn=e('<p tabindex="0" class="btnOk"></p>').on("click",()=>{t._okbtn(),t.hideOpts()}),[t.okbtn[0].innerText]=o.locale,t.cancelBtn=e('<p tabindex="0" class="btnCancel"></p>').on("click",()=>{t._cnbtn(),t.hideOpts()}),[,t.cancelBtn[0].innerText]=o.locale;const l=t.okbtn.add(t.cancelBtn);t.optDiv.append(e('<div class="MultiControls">').append(l)),l.on("keydown.sumo",function(l){const s=e(this);switch(l.which){case 32:case 13:s.trigger("click");break;case 9:if(s.hasClass("btnOk"))return;break;case 27:return t._cnbtn(),void t.hideOpts()}l.stopPropagation(),l.preventDefault()})},_okbtn(){const e=this;let t=0;o.triggerChangeCombined&&(e.E.find("option:checked").length!==e.Pstate.length?t=1:e.E.find("option").each((l,s)=>{s.selected&&e.Pstate.indexOf(l)<0&&(t=1)}),t&&(e.callChange(),e.setText()))},_cnbtn(){const e=this;e.E.find("option:checked").each(function(){this.selected=!1}),e.optDiv.find("li.selected").removeClass("selected");for(let t=0;t<e.Pstate.length;t++)e.E.find("option")[e.Pstate[t]].selected=!0,e.ul.find("li.opt").eq(e.Pstate[t]).addClass("selected");e.setText(),e.selAllState()},_handleMax(){o.max&&(this.selectedCount>=+o.max?this.optDiv.find("li.opt").not(".hidden").each((t,l)=>{e(l).hasClass("selected")||e(l).addClass("temporary-disabled disabled")}):this.optDiv.find("li.opt").not(".hidden").each((t,l)=>{e(l).hasClass("temporary-disabled")&&e(l).removeClass("temporary-disabled disabled")}))},ClearAll(){const t=this;t.is_multi&&(t.selAll=e('<p class="reset-all"><span><i></i></span><label></label></p>'),[,,,t.selAll.find("label")[0].innerText]=o.locale,t.optDiv.addClass("resetAll"),t.selAll.on("click",()=>{t.selAll.removeClass("selected"),t.toggSelAll(!1,1),o.closeAfterClearAll&&t.hideOpts()}),t.optDiv.prepend(t.selAll))},SelAll(){const t=this;t.is_multi&&(t.selAll=e('<p class="select-all"><span><i></i></span><label></label></p>'),[,,t.selAll.find("label")[0].innerText]=o.locale,t.optDiv.addClass("selall"),t.selAll.on("click",()=>{t.selAll.toggleClass("selected"),t.toggSelAll(t.selAll.hasClass("selected"),1),t.selAllState()}),t.optDiv.prepend(t.selAll))},Search(){const l=this,s=l.CaptionCont.addClass("search"),i=e('<p class="no-match">'),a=t.searchFn&&"function"==typeof t.searchFn?t.searchFn:o.searchFn;l.ftxt=e('<input type="search" class="search-txt" value="" autocomplete="off">').on("click",e=>{e.stopPropagation()}),l.ftxt[0].placeholder=o.searchText,s.append(l.ftxt),l.optDiv.children("ul").after(i),l.ftxt.on("input.sumo",()=>{const t=l.optDiv.find("ul.options li.opt").each((t,s)=>{const i=e(s),{0:o}=i.data("opt");o.hidden=a(i.text(),l.ftxt.val(),i),i.toggleClass("hidden",o.hidden)}).not(".hidden");l.optDiv[0].querySelectorAll("li.group").forEach(e=>{e.querySelector("li:not(.hidden)")?e.classList.remove("hidden"):e.classList.add("hidden")}),i.html(o.noMatch.replace(/\{0\}/g,"<em></em>")).toggle(!t.length),i.find("em").text(l.ftxt.val()),l.selAllState()})},selAllState(){const t=this;if(o.selectAll&&t.is_multi){let l=0,s=0;t.optDiv.find("li.opt:not(.disabled):not(.hidden)").each((t,i)=>{e(i).hasClass("selected")&&l++,s++}),l===s?t.selAll.removeClass("partial").addClass("selected"):0===l?t.selAll.removeClass("selected partial"):(o.selectAllPartialCheck&&t.selAll.addClass("partial"),t.selAll.removeClass("selected"))}},showOpts(){const t=this;if(t.E.attr("disabled"))return;t.E.trigger("sumo:opening",t),t.is_opened=!0,t.select.addClass("open").attr("aria-expanded","true");const l=t.optDiv.find("li.opt.selected").first();if(l.length?t.optDiv.find(".options").scrollTop(l.position().top):t.optDiv.find(".options").scrollTop(0),t.E.trigger("sumo:opened",t),t.ftxt?t.ftxt.focus():t.select.focus(),e(document).on("click.sumo",e=>{if(!t.select.is(e.target)&&0===t.select.has(e.target).length){if(!t.is_opened)return;t.hideOpts(),o.okCancelInMulti&&(o.isClickAwayOk?t._okbtn():t._cnbtn())}}),t.is_floating){let l=t.optDiv.children("ul").outerHeight()+2;t.is_multi&&(l+=+t.optDiv.css("padding-bottom")),t.optDiv.css("height",l),e("body").addClass("sumoStopScroll")}t.setPstate()},setPstate(){const e=this;e.is_multi&&(e.is_floating||o.okCancelInMulti)&&(e.Pstate=[],e.E.find("option").each((t,l)=>{l.selected&&e.Pstate.push(t)}))},callChange(){this.E.get().forEach(e=>{l(e,"change"),l(e,"click")})},hideOpts(){const t=this;t.is_opened&&(t.E.trigger("sumo:closing",t),t.is_opened=!1,t.select.removeClass("open").attr("aria-expanded","false").find("ul li.sel").removeClass("sel"),t.E.trigger("sumo:closed",t),e(document).off("click.sumo"),e("body").removeClass("sumoStopScroll"),o.search&&(t.ftxt.val(""),t.ftxt.trigger("input.sumo")))},setOnOpen(){const e=this;let t=e.optDiv.find("li.opt:not(.hidden)").eq(o.search?0:e.E[0].selectedIndex);t.hasClass("disabled")&&(t=t.next(":not(disabled)"),!t.length)||(e.optDiv.find("li.sel").removeClass("sel"),t.addClass("sel"),e.showOpts())},nav(e){const t=this;let l=null,s=t.ul.find("li.opt.sel:not(.hidden)");const i=t.ul.find("li.opt:not(.disabled):not(.hidden)"),o=i.index(s);if(t.is_opened&&s.length){if(e&&o>0)l=i.eq(o-1);else{if(!(!e&&o<i.length-1&&o>-1))return;l=i.eq(o+1)}s.removeClass("sel"),s=l.addClass("sel");const{ul:a}=t,n=a.scrollTop(),d=s.position().top+n;d>=n+a.height()-s.outerHeight()&&a.scrollTop(d-a.height()+s.outerHeight()),d<n&&a.scrollTop(d)}else t.setOnOpen()},basicEvents(){const t=this;t.CaptionCont.on("click",e=>{t.E.trigger("click"),t.is_opened?t.hideOpts():t.showOpts(),e.stopPropagation()}),t.select.on("keydown.sumo",e=>{switch(e.which){case 38:t.nav(!0);break;case 40:t.nav(!1);break;case 65:if(t.is_multi&&!o.max&&e.ctrlKey){t.toggSelAll(!e.shiftKey,1);break}return;case 32:if(o.search&&t.ftxt.is(e.target))return;break;case 13:t.is_opened&&t.optDiv.find("ul li.sel").trigger("click"),o.search?t.select.focus():t.setOnOpen();break;case 9:return void(o.okCancelInMulti||t.hideOpts());case 27:return o.okCancelInMulti&&t._cnbtn(),t.hideOpts(),void(o.search&&t.select.focus());default:return}e.preventDefault()}),e(window).on("resize.sumo",()=>{t.floatingList()})},onOptClick(t){const l=this;t.on("click",function(){const t=e(this);t.hasClass("disabled")||(l.is_multi?(t.toggleClass("selected"),t.data("opt")[0].selected=t.hasClass("selected"),!1===t.data("opt")[0].selected?(l.lastUnselected=t.data("opt")[0].textContent,l.selectedCount--):l.selectedCount++,o.max&&l._handleMax(),l.selAllState()):(t.parent().find("li.selected").removeClass("selected"),t.toggleClass("selected"),t.data("opt")[0].selected=!0,l.selectedCount=1),l.is_multi&&o.triggerChangeCombined&&(l.is_floating||o.okCancelInMulti)||(l.setText(),l.callChange()),l.is_multi||l.hideOpts())})},setText(){const e=this;let t=0;if(e.placeholder="",e.is_multi){const l=e.E.find(":checked").not(":disabled");t=l.length,o.csvDispCount&&l.length>o.csvDispCount?l.length===e.E.find("option").length&&o.captionFormatAllSelected?e.placeholder=o.captionFormatAllSelected.replace(/\{0\}/g,l.length):e.placeholder=o.captionFormat.replace(/\{0\}/g,l.length):e.placeholder=l.toArray().map(e=>e.innerText).join(", ")}else{const l=e.E.find(":checked").not(":disabled");e.placeholder=l.text(),t=l.length}let l=!1;e.placeholder||(l=!0,e.placeholder=e.E.attr("placeholder"),e.placeholder||(e.placeholder=e.E.find("option:disabled:checked").text())),e.select.attr("selected-count",t),e.select.attr("is-selected",t?"true":"false"),e.placeholder=e.placeholder?`${o.prefix} ${e.placeholder}`:o.placeholder,e.caption.text(e.placeholder),o.showTitle&&e.CaptionCont.attr("title",e.placeholder);const s=e.select.find("input.HEMANT123");return s.length&&s.val(e.getSelStr()),l?e.caption.addClass("placeholder"):e.caption.removeClass("placeholder"),e.placeholder},isMobile(){const e=navigator.userAgent||navigator.vendor||window.opera;for(let t=0;t<o.nativeOnDevice.length;t++)if(e.toString().toLowerCase().indexOf(o.nativeOnDevice[t].toLowerCase())>0)return o.nativeOnDevice[t];return!1},setNativeMobile(){const e=this;e.E.addClass("SelectClass"),e.mob=!0,e.E.change(()=>{e.setText()})},floatingList(){const t=this;t.is_floating=e(window).width()<=o.floatWidth,t.optDiv.toggleClass("isFloating",t.is_floating),t.is_floating||t.optDiv.css("height",""),t.optDiv.toggleClass("okCancelInMulti",o.okCancelInMulti&&!t.is_floating)},vRange(e){const t=this,l=t.E.find("option");if(l.length<=e||e<0)throw new Error("index out of bounds");return t},toggSel(t,l){const s=this;let i=null;"number"==typeof l?(s.vRange(l),i=s.E.find("option")[l]):i=s.E.find(`option[value="${l}"]`)[0]||0,i&&!i.disabled&&i.selected!==t&&(o.max&&!i.selected&&s.selectedCount<o.max||i.selected||!o.max&&!i.selected)&&(i.selected=t,s.mob||e(i).data("li").toggleClass("selected",t),s.callChange(),s.setPstate(),s.setText(),s.selAllState())},toggDis(e,t){const l=this.vRange(t);l.E.find("option")[t].disabled=e,e&&(l.E.find("option")[t].selected=!1),l.mob||l.optDiv.find("ul.options li.opt").eq(t).toggleClass("disabled",e).removeClass("selected"),l.setText()},toggSumo(e){const t=this;return t.enabled=e,t.select.toggleClass("disabled",e),e?(t.E.attr("disabled","disabled"),t.select.removeAttr("tabindex")):(t.E.removeAttr("disabled"),t.select.attr("tabindex","0")),t},toggSelAll(t,l){const s=this,i=e.extend(!0,{},e._data(s.E.get(0),"events"));s.E.off(),s.is_multi?t?s.E.find("option").toArray().filter(e=>!e.selected&&!e.disabled&&"none"!==e.style.display).forEach(t=>{e(t).data("li").hasClass("hidden")||(t.selected=!0,e(t).data("li").toggleClass("selected",!0))}):s.E.find("option").toArray().filter(e=>e.selected&&!e.disabled&&"none"!==e.style.display).forEach(t=>{e(t).data("li").hasClass("hidden")||(t.selected=!1,e(t).data("li").toggleClass("selected",!1))}):t?console.warn("You called `SelectAll` on a non-multiple select"):s.E[0].selectedIndex=-1,e.each(i,(t,l)=>{e.each(l,(e,t)=>{s.E.on(t.type,t.handler)})}),(s.is_multi&&!o.okCancelInMulti||!s.is_multi)&&(s.callChange(),s.setText()),l||(!s.mob&&s.selAll&&s.selAll.removeClass("partial").toggleClass("selected",!!t),s.setText(),s.setPstate())},reload(){const t=this.unload();return e(t).SumoSelect(o)},unload(){const e=this;return e.select.before(e.E),e.E.show(),e.E[0].classList.remove("SumoUnder","SelectClass"),o.outputAsCSV&&e.is_multi&&e.select.find("input.HEMANT123").length&&e.E.attr("name",e.select.find("input.HEMANT123").attr("name")),e.select.remove(),delete i.sumo,e.E.trigger("sumo:unloaded",e),i},add(t,l,s,o){if(void 0===t)throw new Error("No value to add");const a=this,n=a.E.find("option"),d=t;let c=l,r=s;"number"==typeof l?(r=l,c=t):void 0===l&&(c=t);const p=e("<option></option>").val(d).html(c);if(o&&"object"==typeof o&&e.each(o,(e,t)=>{p.attr(e,t)}),n.length<r)throw new Error("index out of bounds");return void 0===r||n.length===r?(a.E.append(p),a.mob||a.ul.append(a.createLi(p))):(n.eq(r).before(p),a.mob||a.ul.find("li.opt").eq(r).before(a.createLi(p))),i},remove(e){const t=this.vRange(e);t.E.find("option").eq(e).remove(),t.mob||t.optDiv.find("ul.options li.opt").eq(e).remove(),t.setText()},removeAll(){const e=this,t=e.E.find("option");for(let l=t.length-1;l>=0;l--)!0!==t[l].selected&&e.remove(l)},find(e){const t=this,l=t.E.find("option");for(const t in l)if(l[t].value===e)return+t;return-1},selectItem(e){this.toggSel(!0,e)},unSelectItem(e){this.toggSel(!1,e)},selectAll(){this.toggSelAll(!0)},unSelectAll(){this.toggSelAll(!1)},disableItem(e){this.toggDis(!0,e)},enableItem(e){this.toggDis(!1,e)},enabled:!0,enable(){return this.toggSumo(!1)},disable(){return this.toggSumo(!0)},init(){const e=this;return e.createElems(),e.setText(),e.E.trigger("sumo:initialized",e),e}},i.sumo.init()});return 1===i.length?i[0]:i}});